import{m as x,G as ye,H as z,d as he,h as y,I as ke,c as W,w as ge,o as be,J as we,a as p,k as c,b as i,j as M,T as xe,l as v,u as l,K as Ce,p as Ie,g as B,v as _e,F as E,r as X,x as C,L as P,e as a,M as Se,B as D,n as Y,t as V,N as Ae,q as Me}from"./index-CL5__TWX.js";import{C as Be,_ as De,a as Te}from"./EmptyState.vue_vue_type_script_setup_true_lang-kU1beilK.js";import{C as j,a as Z,_ as ee,b as te}from"./BaseButton.vue_vue_type_script_setup_true_lang-HVmhRfnF.js";import{a as T,o as $e}from"./index-XR5uOQR1.js";import{C as Fe,b as Ne,g as se}from"./format-CGxH6fZv.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=x("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=x("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=x("funnel-plus",[["path",{d:"M13.354 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14v6a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341l1.218-1.348",key:"8mvsmf"}],["path",{d:"M16 6h6",key:"1dogtp"}],["path",{d:"M19 3v6",key:"1ytpjt"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=x("inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=x("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=x("square-check",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=x("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function ae(o=6){const u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let r="";for(let n=0;n<o;n++)r+=u.charAt(Math.floor(Math.random()*u.length));return r}function g(o,u=!1){if(Array.isArray(o))return o.map(r=>g(r,u));if(o instanceof Date)return u?o.toISOString():new Date(o.getTime());if(o instanceof Map)if(u){const r={};for(const[n,h]of o.entries())r[n]=g(h,u);return r}else{const r=new Map;for(const[n,h]of o.entries())r.set(g(n,u),g(h,u));return r}else if(o instanceof Set){if(u)return Array.from(o).map(r=>g(r,u));{const r=new Set;for(const n of o.values())r.add(g(n,u));return r}}else if(o!==null&&typeof o=="object"){const r=ye(o)?z(o):o,n={};for(const h in r)n[h]=g(r[h],u);return n}return o}const ze={class:"px-4 pb-[4rem] flex flex-col flex-1 overflow-y-auto space-y-2"},He={class:"flex flex-row items-center gap-1"},qe={key:0,class:"flex flex-1 items-center"},Ge={key:1,class:"max-w-full space-y-2 overflow-hidden mt-1"},Je={class:"bg-slate-50 border-slate-200 border me-3 rounded-md p-2 shrink-0"},Ke={class:"w-5 h-5 flex justify-center items-center text-slate-400 font-bold"},Qe={class:"flex flex-row text-xs text-slate-500 space-x-2"},We=["onClick"],Xe={key:2},Pe={class:"flex items-center space-x-2"},Ye={class:"text-lg font-semibold me-auto"},Ze={class:"space-y-4"},et={key:0,class:"space-y-4"},tt={class:"py-2 space-y-4 max-h-50 overflow-y-scroll"},st={class:"text-gray-500 text-sm"},at={class:"space-y-5 relative"},nt={class:"flex items-center justify-between"},ut=he({__name:"ManageableItems",props:{data:{},addSubItemAble:{type:Boolean},disableItemOnClicked:{},listAutoOpen:{type:Boolean},overrideChildClicked:{type:Function},fetchAll:{type:Function},getById:{type:Function},add:{type:Function},update:{type:Function},updateItem:{type:Function},remove:{type:Function},removeItem:{type:Function}},emits:["selectedItem"],setup(o,{emit:u}){const r=u,n=o,h=y(null),_=ke(n,"data"),f=y(""),H=y(""),$=y(""),F=y(""),q=y(""),m=y([]),N=y(null),w=y([]),[I,ne]=T(),[G,le]=T(),[S,b]=T(),[L,O]=T(),k=W(()=>{const t=f.value;if(!t)return null;if(t.includes("#")){const[e,d]=t.split("#"),A=_.value.find(U=>U.id===e);return!A||!A.items?null:A.items.find(U=>U.id===d)}return _.value.find(e=>e.id===t)});ge(S,t=>{t||(F.value="",I.value=t,m.value=[])});const J=W(()=>{const t=$.value.toLowerCase();return _.value.map(s=>{if(s.name.toLowerCase().includes(t))return s;const e=(s.items??[]).filter(d=>d.name.toLowerCase().includes(t));return e.length>0?(f.value=s.id,{...s,items:e}):null}).filter(Boolean)}),oe=async()=>{const t=k.value??{},s=Ne(h.value);if(f.value.indexOf("#")>-1){t.name=F.value||t.name,t.meta=s.meta,t.updatedAt=new Date;const e=f.value.split("#");if(!(await n?.updateItem?.(e[0],e[1],t)).success){alert("failed updating data");return}b();return}if(m.value.length&&(m.value=m.value.map(e=>z(e)),t.items=z(m.value).map(e=>({...e,icon:e.icon??se(e.name),createdAt:new Date})).filter(e=>e.name!=="")),t.id){const e={...t,...s};if(e.updatedAt=new Date,!(await n.update(k.value?.id,g(e))).success){alert("failed updating data");return}}else{const e={...t,...s,id:ae(5)};if(e.createdAt=new Date,e.icon??=se(e.name),!(await n.add(g(e))).success){alert("failed save data");return}}b()},re=async()=>{if(f.value.indexOf("#")>-1){const t=f.value.split("#");(await n?.removeItem?.(t[0],t[1])).success||alert("failed deleting data")}else(await n.remove(k.value?.id)).success||alert("failed deleting data");b()};function ie(){f.value="",b()}function de(){const t=y({id:ae(5),name:"",meta:{new:!0}});q.value=t.value.id,m.value.length<1&&_.value.find(s=>s.id===k.value?.id)?.items?.forEach(s=>{m.value.push({id:s.id,name:s.name})}),m.value.push(t.value)}function ce(){m.value=m.value.filter(t=>!t.meta)}function R(t,s){switch(r("selectedItem",s),t){case"parent":{if(n.disableItemOnClicked=="parent")return;f.value=s,H.value=t;break}case"child":{if(n.disableItemOnClicked=="child")return;if(n.overrideChildClicked){n.overrideChildClicked();return}f.value=s,H.value=t,b();break}}}function K(t){t.key==="Escape"&&(b(!1),O(!1))}function ue(){le()}function fe(t){return w.value.findIndex(s=>s===t)>-1}function me(t){w.value.findIndex(e=>e===t)>-1?w.value=w.value.filter(e=>e!==t):w.value=[...w.value,t]}function pe(){w.value.forEach(async t=>{await n.remove(t)})}function ve(){O()}function Q(){b(!1),O(!1)}return $e(N,ue,{modifiers:{prevent:!0}}),be(async()=>{window.addEventListener("keydown",K)}),we(()=>{window.removeEventListener("keydown",K)}),(t,s)=>(a(),p(E,null,[(a(),c(xe,{to:"#action-left-teleport"},[i("button",{class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:s[0]||(s[0]=e=>l(Ce).push({name:"dashboard"}))},[(a(),c(v(l(Fe))))])])),i("div",ze,[i("div",He,[Ie(i("input",{type:"text",class:"w-full p-2 rounded-sm focus:outline-none bg-gray-100",placeholder:"Search","onUpdate:modelValue":s[1]||(s[1]=e=>$.value=e)},null,512),[[_e,$.value]]),l(G)?(a(),p("div",{key:0,ref_key:"deleteAllRef",ref:N,class:"bg-gray-100 p-2 rounded-sm",onClick:pe},[(a(),c(v(l(j)),{class:"text-white fill-red-400"}))],512)):(a(),p("div",{key:1,ref_key:"deleteAllRef",ref:N,class:"bg-gray-100 p-2 rounded-sm",onClick:ie},[(a(),c(v(l(Be)),{class:"stroke-gray-500"}))],512)),t.$slots.filterBottomSheet?(a(),p("div",{key:2,class:"bg-gray-100 p-2 rounded-sm",onClick:ve},[(a(),c(v(l(Re)),{class:"stroke-gray-500"}))])):B("",!0)]),J.value.length?(a(),p("div",Ge,[(a(!0),p(E,null,X(J.value,e=>(a(),c(Te,{key:e.id,id:e.id,name:e.name,subName:e.subName,"onUpdate:parent:selected":R,"onUpdate:child:selected":R,"list-opened":f.value.includes(e.id),items:e.items,"list-auto-open":n.listAutoOpen},Se({icon:C(()=>[i("div",Je,[i("div",Ke,V(e.icon),1)])]),action:C(({id:d})=>[i("div",Qe,[f.value.includes(d)?(a(),p("button",{key:0,onClick:()=>{R("parent",d),l(b)()},class:"bg-slate-50 px-2 border-1 border-slate-200 rounded text-gray-500 focus:bg-slate-100"},"Edit",8,We)):B("",!0),l(G)?(a(),c(v(l(Ve)),{key:1,class:Y(["size-5 stroke-2",fe(d)?"text-white fill-red-400":"text-slate-400"]),onClick:A=>me(d)},null,8,["class","onClick"])):(a(),p("div",Xe,[f.value.indexOf(d)>-1?(a(),c(v(l(Le)),{key:0,class:"w-4"})):(a(),c(v(l(Oe)),{key:1,class:"w-4"}))]))])]),_:2},[t.$slots.space?{name:"space",fn:C(()=>[D(t.$slots,"space",{data:e})]),key:"0"}:void 0,t.$slots.spacesub?{name:"spacesub",fn:C(({data:d})=>[D(t.$slots,"spacesub",{data:d})]),key:"1"}:void 0]),1032,["id","name","subName","list-opened","items","list-auto-open"]))),128))])):(a(),p("div",qe,[M(De,{message:"Items Not Found",icon:l(Ue)},null,8,["icon"])]))]),M(Z,{show:l(S),"onUpdate:show":s[5]||(s[5]=e=>P(S)?S.value=e:null)},{default:C(()=>[i("form",{ref_key:"formRef",ref:h,class:"space-y-5 relative",onSubmit:s[4]||(s[4]=Me(()=>l(I)?re():oe(),["prevent"]))},[i("div",Pe,[i("h2",Ye,V(k.value?"Edit":"Add")+" Item",1),f.value.indexOf("#")==-1&&n.addSubItemAble?(a(),c(v(l(Ee)),{key:0,class:"text-gray-500",onClick:de})):B("",!0),(a(),c(v(l(je)),{class:Y([l(I)?"text-red-500":"text-gray-500"]),onClick:s[2]||(s[2]=()=>l(ne)())},null,8,["class"])),(a(),c(v(l(j)),{class:"text-gray-500",onClick:Q}))]),i("div",Ze,[M(ee,{input:"",name:"name",label:"Name",selected:"Name","model-value":k.value?.name??"","onUpdate:modelValue":s[3]||(s[3]=e=>F.value=e)},null,8,["model-value"]),D(t.$slots,"form",{data:k.value}),m.value.length>0?(a(),p("div",et,[s[8]||(s[8]=i("div",{class:"border-2 border-dotted border-gray-300"},null,-1)),i("div",{class:"flex items-center space-x-2"},[s[7]||(s[7]=i("h2",{class:"text-lg font-semibold"},"Sub Item",-1)),i("button",{class:"text-gray-400 underline",type:"button",onClick:ce},"clear")]),i("div",tt,[(a(!0),p(E,null,X(m.value,e=>(a(),c(ee,Ae({key:e.id,input:"",label:e.id},{ref_for:!0},e.meta?.new?{labelAlias:"New!",labelClass:"bg-amber-300"}:!1,{id:e.id,"model-value":e.name??"",selected:q.value,"onUpdate:modelValue":d=>e.name=d}),null,16,["label","id","model-value","selected","onUpdate:modelValue"]))),128))])])):B("",!0)]),i("h6",st,V(l(I)&&k.value?.items?.length?`Because this is parent item,
        there is
        (${k.value?.items?.length}) subs items also will be deleted.`:""),1),l(I)?(a(),c(te,{key:0,class:"w-full",variant:"fill",color:"red",rounded:"sm",size:"md",text:"Warning: This action cannot be undone!",type:"submit"})):(a(),c(te,{key:1,class:"w-full",variant:"fill",color:"orange",rounded:"sm",size:"md",text:"Save",type:"submit"}))],544)]),_:3},8,["show"]),M(Z,{show:l(L),"onUpdate:show":s[6]||(s[6]=e=>P(L)?L.value=e:null)},{default:C(()=>[i("div",at,[i("div",nt,[s[9]||(s[9]=i("h2",{class:"text-lg font-semibold me-auto"},"Filter",-1)),(a(),c(v(l(j)),{class:"text-gray-500",onClick:Q}))]),D(t.$slots,"filterBottomSheet")])]),_:3},8,["show"])],64))}});export{Ue as I,ut as _};
