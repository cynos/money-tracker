import{C as B,b as K,a as W,_ as Y}from"./BaseButton.vue_vue_type_script_setup_true_lang-BheV5iJ5.js";import{m as P,d as F,h as g,w as H,o as q,a as v,e as r,b as l,t as D,k as y,l as x,u as c,F as E,r as N,n as Z,c as S,O as ee,I as R,s as te,P as ae,j as _,Q as se,T as oe,x as L,R as le,g as z,L as ne,N as re,H as O}from"./index-BTVEsdd2.js";import{u as ie,_ as ce}from"./categoryStore-CuUzrNnL.js";import{u as de}from"./assetStore-D16u2jrt.js";import{u as ue,t as U}from"./transactionStore-CKwxT-Vb.js";import{l as w}from"./localDataStore-BGLHiYx-.js";import{C as me,c as fe}from"./format-BOdMUDrb.js";import{a as pe}from"./index-CbWGplPa.js";/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=P("calendar-search",[["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 11.75V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h7.25",key:"1jrsq6"}],["path",{d:"m22 22-1.875-1.875",key:"13zax7"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=P("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-vue-next v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=P("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),he={class:"bg-white overflow-x-auto"},xe={class:"flex items-center justify-between px-4 py-2 bg-black text-white text-sm font-semibold"},be={class:"flex items-center gap-2"},ke={class:"grid grid-cols-3 text-xs font-medium"},_e=["onClick"],we={class:"flex flex-col items-center justify-center h-[4rem]"},Ce={class:"text-xl"},V=3,Te=F({__name:"TabsPanel",props:{title:{},data:{}},emits:["select","edit","close"],setup(M,{emit:C}){const b=M,h=g(""),i=g([...b.data]);H(()=>b.data,n=>{i.value=[...n]});function T(n){h.value=n;const d=i.value.find(s=>s.id==n);p("select",d),i.value=i.value.filter(s=>!s.sub&&!s.empty);for(let s=0;s<i.value.length;s++){const u=i.value[s];if(u.id==n&&u.items){const k=Math.floor(s/V+1),$=f(i.value,V),e=V*k;if($>0)for(let m=0;m<$;m++)i.value.push({empty:!0});const j=f(u.items,V);for(let m=0;m<j;m++)u.items?.unshift({});u.items?.forEach(m=>{i.value.splice(e,0,{...m,sub:!0})})}}}q(()=>{i.value=i.value.filter(n=>{if(n.id)return!0})});const p=C;function f(n,d){return(d-n.length%d)%d}return(n,d)=>(r(),v("div",he,[l("div",xe,[l("span",null,D(M.title),1),l("div",be,[l("button",{onClick:d[0]||(d[0]=s=>n.$emit("edit"))},[(r(),y(x(c(ve))))]),l("button",{onClick:d[1]||(d[1]=s=>n.$emit("close"))},[(r(),y(x(c(B))))])])]),l("div",ke,[(r(!0),v(E,null,N(i.value,(s,u)=>(r(),v("div",{key:`${s.name}-${u}`,class:Z(["basis-1/3 text-center p-2 cursor-pointer",[h.value===s.id?"bg-slate-100 text-red-500":s.sub?"bg-gray-100":"bg-white text-gray-700"]]),onClick:k=>s.name!=""&&!s.empty&&T(s.id)},[l("div",we,[l("div",Ce,D(s.icon),1),l("div",null,D(s.name),1)])],10,_e))),128))])]))}}),$e={class:"flex flex-col flex-1"},Se={class:"flex flex-row gap-2 items-center px-4 mb-2"},Ve=["onClick"],De={class:"text-sm font-medium"},Ee={class:"flex flex-col flex-1"},Me={class:"space-y-5 p-4 w-full flex-1 overflow-auto"},je={class:"flex flex-row items-center justify-center space-x-2"},Ae={key:0,class:"w-full flex-1"},Ie={class:"space-y-5 relative"},Le={class:"flex items-center justify-between"},He=F({__name:"TransactionPage",setup(M){const C=se(),b=ae(),h=ie(),i=de(),T=ue(),p=g("Total"),f=g(!1),n=g("Outcome"),d=g(""),s=g([]),[u,k]=pe(),$=S(()=>h.categories.filter(t=>t.meta?.categoryType===n.value)),e=ee({total:"",category:{},asset:{},notes:"",type:n.value,time:new Date,detail:""}),j=[{label:"Total",placeholder:"Amount of Transaction",formType:"input",model:S({get:()=>e.total??d.value,set:t=>e.total=t.replace(/[^\d]/g,"")}),input:!0,number:"currency"},{label:"Category",placeholder:"Transportation, Foods, Etc ..",formType:"input",model:S({get:()=>e.category.name??"",set:t=>e.category.name=t})},{label:"Asset",placeholder:"Source Balance",formType:"input",model:S({get:()=>e.asset.name??"",set:t=>e.asset.name=t})},{label:"Notes",placeholder:"Transaction Notes",model:R(e,"notes"),input:!0,formType:"input"},{label:"Detail (optional)",placeholder:"...",model:R(e,"detail"),input:!0,formType:"textarea"}];H(n,t=>{e.type=t,s.value.forEach(o=>{if(o.name==="Category"){o.data=$.value;return}})}),te(()=>{m(p.value)});function m(t){switch(p.value=t,t){case"Total":f.value=!1;return;case"Category":f.value=!0;return;case"Asset":f.value=!0;return;case"Notes":f.value=!1;return}}const Q=async t=>{switch(p.value){case"Category":{e.category={id:t.id,name:t.name};return}case"Asset":{e.asset={id:t.id,name:t.name};return}}},X=()=>{k()},G=()=>{f.value=!1},J=async()=>{for(const[t,o]of Object.entries(e))switch(t){case"category":if(!o||Object.keys(o).length===0){alert("category cannot be empty");return}case"asset":if(!o||Object.keys(o).length===0){alert("asset cannot be empty");return}}b.query.action=="edit"&&e.id?await T.update(e.id,O(e)):(e.time=new Date(w.value.selectedDate),await T.add(O(e))),C.push("/")};return q(async()=>{if(await h.fetchAll(),await i.fetchAll(),s.value.push({name:"Category",data:h.categories},{name:"Asset",data:i.assets}),w.value.selectedDate&&(e.time=new Date(w.value.selectedDate)),b.query.action=="edit"&&w.value.selectedTransactionItem){const t=w.value.selectedTransactionItem;e.category=t.category,e.asset=t.asset,e.id=t.id,e.notes=t.notes,e.time=t.time,e.total=t.total,e.type=t.type,e.time=t.time,e.detail=t.detail}}),(t,o)=>(r(),v(E,null,[(r(),y(oe,{to:"#action-left-teleport"},[l("button",{class:"p-2 rounded-md text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:o[0]||(o[0]=a=>c(C).push("/"))},[(r(),y(x(c(me))))])])),l("div",$e,[l("div",Se,[_(c(le),{modelValue:e.time,"onUpdate:modelValue":o[1]||(o[1]=a=>e.time=a),mode:"date",color:"orange"},{default:L(({togglePopover:a})=>[l("div",{class:"flex flex-row gap-2 items-center text-gray-500 bg-gray-100 rounded-md border border-gray-200 px-4 py-2",onClick:a},[(r(),y(x(c(ye)),{class:"size-6"})),l("span",De,D(c(fe)(e.time.toISOString())),1)],8,Ve)]),_:1},8,["modelValue"]),_(ce,{initialIndex:[...c(U)].findIndex(a=>a.includes(n.value)),modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=a=>n.value=a),class:"w-full bg-gray-100 rounded-md border border-gray-200 text-gray-500",data:[...c(U)]},null,8,["initialIndex","modelValue","data"])]),l("div",Ee,[l("div",Me,[(r(),v(E,null,N(j,(a,A)=>_(Y,re({key:A},{ref_for:!0},{label:a.label,helper:a.helper,input:a.input,number:a.number,placeholder:a.placeholder,formType:a.formType},{modelValue:a.model.value,"onUpdate:modelValue":I=>a.model.value=I,selected:p.value,"onUpdate:selected":o[3]||(o[3]=I=>p.value=I),onClick:m}),null,16,["modelValue","onUpdate:modelValue","selected"])),64)),_(K,{type:"input",variant:"fill",color:"orange",class:"w-full",onClick:J},{default:L(()=>[l("div",je,[(r(),y(x(c(ge)),{class:"w-4 h-4"})),o[6]||(o[6]=l("span",null,"Save",-1))])]),_:1})]),f.value?(r(),v("div",Ae,[(r(!0),v(E,null,N(s.value,(a,A)=>(r(),v("div",{key:`${a.name}-${A}`},[a.name==p.value?(r(),y(Te,{key:0,title:a.name,data:a.data,onClose:G,onSelect:Q,onEdit:X},null,8,["title","data"])):z("",!0)]))),128))])):z("",!0)])]),_(W,{show:c(u),"onUpdate:show":o[5]||(o[5]=a=>ne(u)?u.value=a:null)},{default:L(()=>[l("div",Ie,[l("div",Le,[o[7]||(o[7]=l("h2",{class:"text-lg font-semibold me-auto"},"Add / Edit Category",-1)),(r(),y(x(c(B)),{class:"text-gray-500",onClick:o[4]||(o[4]=a=>c(k)())}))])])]),_:1},8,["show"])],64))}});export{He as default};
